% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/icms.ssc.R
\name{iCMS.DQ}
\alias{iCMS.DQ}
\title{Classify bulk gene-expression samples using the Distance-Quantile (DQ) single-sample predictor}
\usage{
iCMS.DQ(
  ivect,
  min.cor = 0.1,
  min.dist = 0.05,
  q = 0.9,
  metric = "kendall",
  allgenes = FALSE,
  min.genes = 30,
  stratify.ds = FALSE,
  weighted.genes = FALSE,
  jobs = 4,
  verbose = FALSE
)
}
\arguments{
\item{ivect}{Gene-expression matrix with gene symbols as row names and samples as columns.
Values should be log-transformed.}

\item{min.cor}{Minimum quantile similarity required for a confident call (default 0.1).}

\item{min.dist}{Minimum scaled margin between i2 and i3 scores for a confident call (default 0.05).}

\item{q}{Quantile used to summarise per-class similarities (default 0.9).
Values 0.9–1 suit non-batch-corrected data; 0.6–0.7 suit batch-corrected data.}

\item{metric}{Similarity metric: "pearson", "kendall" (default), "spearman", or "cosine".}

\item{allgenes}{Use extended gene set (default FALSE; uses epithelial genes only).}

\item{min.genes}{Minimum gene overlap required (default 30).}

\item{stratify.ds}{If TRUE, compute per-dataset quantile margins and aggregate, removing
the confounding effect of platform-level similarity differences (default FALSE).}

\item{weighted.genes}{If TRUE, up-weight discriminative genes by their absolute
t-statistic when metric is "pearson" or "cosine"; for rank-based metrics restricts
to the top 100 most discriminative genes (default FALSE).}

\item{jobs}{Number of parallel cores. Set to 1 to disable parallelism (default 4).}

\item{verbose}{If TRUE, include all 192 prototype-level similarity columns in the output.
Default FALSE returns 7 summary columns only.}
}
\value{
A data frame with one row per sample. Key columns: nearest.icms, confident.icms.
}
\description{
Estimates the most probable iCMS subtype for each sample by comparing its similarity to
synthetic exemplar centroids from three training cohorts (Marisa, PETACC, TCGA), using
the q-quantile of per-class similarities as the decision score.
}
