% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/icms.ssc.R
\name{iCMS.KNN}
\alias{iCMS.KNN}
\title{Classify bulk gene-expression samples using the K-Nearest Neighbours (KNN) method}
\usage{
iCMS.KNN(
  ivect,
  nn = 10,
  metric = "kendall",
  allgenes = FALSE,
  min.genes = 30,
  mcenter = FALSE,
  stratify.ds = FALSE,
  weighted.genes = FALSE,
  jobs = 4,
  verbose = FALSE
)
}
\arguments{
\item{ivect}{Gene-expression matrix with gene symbols as row names and samples as columns.
Values should be log-transformed.}

\item{nn}{Number of nearest neighbours (default 10).}

\item{metric}{Similarity metric: "pearson", "kendall" (default), "spearman", or "cosine".}

\item{allgenes}{Use extended gene set (default FALSE; uses epithelial genes only).}

\item{min.genes}{Minimum gene overlap required (default 30).}

\item{mcenter}{Mean-centre each sample before computing cosine similarity (default FALSE;
has no effect for correlation-based metrics).}

\item{stratify.ds}{If TRUE, vote is stratified by training dataset, preventing a single
batch-matched cohort from dominating the top-nn neighbours (default FALSE).}

\item{weighted.genes}{If TRUE, up-weight discriminative genes by their absolute
t-statistic when metric is "pearson" or "cosine"; for rank-based metrics restricts
to the top 100 most discriminative genes (default FALSE).}

\item{jobs}{Number of parallel cores. Set to 1 to disable parallelism (default 4).}

\item{verbose}{If TRUE, include individual neighbour labels, similarities, and dataset
labels in the output (default FALSE).}
}
\value{
A data frame with one row per sample. Key columns: nearest.icms, confident.icms.
}
\description{
Estimates the most probable iCMS subtype for each sample by majority vote among the
nn most similar prototype columns, with votes weighted by similarity score.
}
