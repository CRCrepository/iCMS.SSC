% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_knn.R
\name{knn.vect}
\alias{knn.vect}
\title{Classify a single sample using the K-Nearest Neighbours (KNN) method}
\usage{
knn.vect(
  v,
  nn,
  metric,
  allgenes,
  min.genes,
  mcenter = FALSE,
  stratify.ds = FALSE,
  weighted.genes = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{v}{Named numeric vector of (log-transformed) gene expression values.}

\item{nn}{Number of nearest neighbours (default 10).}

\item{metric}{Similarity metric: "pearson", "kendall" (default), "spearman", or "cosine".}

\item{allgenes}{Use extended gene set (default FALSE; uses epithelial genes only).}

\item{min.genes}{Minimum gene overlap with the prototype set (default 30).}

\item{mcenter}{Mean-centre the sample before computing similarity. Only relevant for
cosine similarity (correlation metrics are shift-invariant). Default FALSE.}

\item{stratify.ds}{If TRUE, vote is stratified by training dataset: for each dataset the
class whose best prototype is most similar wins one vote, then votes are tallied across
datasets. This prevents a single batch-matched dataset from dominating the top-nn
neighbours. Default FALSE.}

\item{weighted.genes}{If TRUE, restrict computation to the top 100 most discriminative
genes (by absolute t-statistic); for "pearson" and "cosine" uses weighted correlation /
weighted cosine instead. Default FALSE.}

\item{verbose}{If TRUE, return individual neighbour labels, similarities, and dataset
labels as additional columns. Default FALSE.}
}
\value{
A one-row data frame with columns: qi2, qi3, i2, i3, i2i3, nearest.icms,
confident.icms, nearest.ds, ngenes (plus neighbour details when verbose = TRUE).
}
\description{
Classify a single sample using the K-Nearest Neighbours (KNN) method
}
